<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>V√≤ng Quay May M·∫Øn</title>
  <style>
    body{
      font-family: Arial, sans-serif;
      background:#0b132b;
      color:white;
      text-align:center;
    }
    .wheel-container{
      position:relative;
      width:300px;
      height:300px;
      margin:40px auto;
    }
    canvas{
      background:#fff;
      border-radius:50%;
    }
    .pointer{
      width:0;
      height:0;
      border-left:15px solid transparent;
      border-right:15px solid transparent;
      border-bottom:30px solid red;
      position:absolute;
      top:-25px;
      left:50%;
      transform:translateX(-50%);
    }
    button{
      margin-top:20px;
      padding:10px 20px;
      font-size:16px;
      cursor:pointer;
      border:none;
      border-radius:5px;
    }
    .result{
      margin-top:15px;
      font-size:18px;
      color:#ffd166;
    }
  </style>
</head>
<body>

<h2>üéÅ V√íNG QUAY MAY M·∫ÆN</h2>

<div class="wheel-container">
  <div class="pointer"></div>
  <canvas id="wheel" width="300" height="300"></canvas>
</div>

<button onclick="spin()">QUAY NGAY</button>
<div class="result" id="result"></div>

<script>
const rewards = [
  "Skin kh·ªßng long",
  "1000 Point Shop",
  "Pet mini",
  "VIP 7 ng√†y",
  "VIP 30 ng√†y",
  "Th√∫ huy·ªÅn tho·∫°i"
];

const canvas = document.getElementById("wheel");
const ctx = canvas.getContext("2d");
const size = canvas.width;
const center = size / 2;
const slice = 2 * Math.PI / rewards.length;
let angle = 0;
let spinning = false;

// V·∫Ω v√≤ng quay
function drawWheel(){
  for(let i=0;i<rewards.length;i++){
    ctx.beginPath();
    ctx.moveTo(center, center);
    ctx.arc(center, center, center, angle + i*slice, angle + (i+1)*slice);
    ctx.fillStyle = i % 2 === 0 ? "#3a86ff" : "#8338ec";
    ctx.fill();
    ctx.save();
    ctx.translate(center, center);
    ctx.rotate(angle + i*slice + slice/2);
    ctx.textAlign="right";
    ctx.fillStyle="white";
    ctx.font="14px Arial";
    ctx.fillText(rewards[i], center-10, 5);
    ctx.restore();
  }
}

drawWheel();

function spin(){
  if(spinning) return;
  spinning = true;
  document.getElementById("result").innerHTML="";

  const spinTime = 4000;
  const finalAngle = Math.random()*360 + 1440; // quay nhi·ªÅu v√≤ng
  const start = Date.now();

  function animate(){
    const now = Date.now();
    const elapsed = now - start;
    const progress = Math.min(elapsed / spinTime, 1);
    const ease = 1 - Math.pow(1 - progress, 3);

    angle = (finalAngle * ease) * Math.PI / 180;
    ctx.clearRect(0,0,size,size);
    drawWheel();

    if(progress < 1){
      requestAnimationFrame(animate);
    }else{
      spinning = false;
      showResult();
    }
  }
  animate();
}

function showResult(){
  const deg = angle * 180 / Math.PI + 90;
  const index = rewards.length - Math.floor((deg % 360) / (360 / rewards.length)) - 1;
  const reward = rewards[(index + rewards.length) % rewards.length];

  document.getElementById("result").innerHTML =
    "üéâ B·∫°n tr√∫ng: <b>" + reward + "</b>";
}
</script>

</body>
</html>
